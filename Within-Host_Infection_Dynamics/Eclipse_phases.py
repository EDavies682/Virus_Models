# Korosec et al. (2023)import matplotlib.pyplot as pltimport numpy as npfrom scipy.integrate import odeint# within-host infection dynamics with eclipse phase# Multiple cohort study of hospitalized SARS-CoV-2 in-host infection dynamics: Parameter estimates, identifiability, sensitivity and the eclipse phase profilet = np.linspace(0, 40, num=1000)k = input("Enter the number of eclipse stages: ")k = int(k)if k == 0:    print("No eclipse phase (instant virus production).")elif k == 1:    print("Exponential exlipse phase (high variability).")else:    print("Erlang exlipse phase (realistic delay).")    alpha = 4.93e-5D = 1E = 5epsilon = 0.001B = 8000C = 5t_inf = 1params = [alpha, D, k, E, epsilon, B, C, t_inf]def sim(variables, t, params):        # parameters    alpha, D, k, E, epsilon, B, C, t_inf = params            # Target cells    yT = variables[0]        # Eclipse stage 1 to k    y_eclipse = variables[1:1 + k]        # Budding    yB = variables[1 + k]        # Infectious Virions    v = variables[2 + k]        # Non-nfectious Virions    w = variables[3 + k]        # equations        #derivative vector    dy = [0] * (4 + k)        # Target cells    dy[0] = -alpha * yT * v        if k == 0:        # no eclipse phase        dy[1] = alpha * yT * v - D * yB    else:        # Eclipse stage 1        dy[1] = alpha * yT * v - (D + k*E) * y_eclipse[0]                # Eclipse stages 2...k        for j in range(1, k):            dy[1+j] = k* E * y_eclipse[j-1] - (D + k * E) * y_eclipse[j]             # Budding cells        dy[1+k] = k * E * y_eclipse[-1] -D * yB        # Infected virus    dy[2+k] = epsilon * B * yB - alpha * yT * v - C * v        # Non-infectious virus    dy[3+k] = (1 - epsilon) * B * yB - C * w        return dy# Initial conditionsyT0 = 1.33e5y_eclipse0 = [0] * kyB0 = 1 / 30v0 = 0w0 = 0y0 = [yT0] + y_eclipse0 + [yB0, v0, w0]y = odeint(sim, y0, t, args=(params,))fig, axes = plt.subplots(4 + k, 1, figsize=(7, 12), sharex=True)axes[0].plot(t, y[:,0])axes[0].set_ylabel("Target cells")if k > 0:    for i in range(k):        axes[1 + i].plot(t, y[:, 1 + i])        axes[1 + i].set_ylabel(f"Eclipse stage {i + 1}")    axes[1 + k].plot(t, y[:,1 +k ])    axes[1 + k].set_ylabel("Budding cells")    axes[2 + k].plot(t, y[:,2 + k])    axes[2 + k].set_ylabel("Infectious virus")    axes[3 + k].plot(t, y[:,3 + k])    axes[3 + k].set_ylabel("Non-infectious virus")    axes[3 + k].set_xlabel("Time (days)")else:    axes[1].plot(t, y[:,1])    axes[1].set_ylabel("Budding cells")    axes[2].plot(t, y[:,2])    axes[2].set_ylabel("Infectious virus")    axes[3].plot(t, y[:,3])    axes[3].set_ylabel("Non-infectious virus")    axes[3].set_xlabel("Time (days)")plt.tight_layout()plt.show()idx_v = 2 + kidx_w = 3 + kviral_load = y[:, idx_v] + y[:, idx_w]plt.figure(figsize=(7,4))plt.plot(t, np.log10(viral_load + 1))plt.ylabel("log10 viral load")plt.xlabel("Time (days)")plt.show()