import matplotlib.pyplot as pltimport numpy as npfrom scipy.integrate import odeint# within-host infection dynamics with eclipse phase# Multiple cohort study of hospitalized SARS-CoV-2 in-host infection dynamics: Parameter estimates, identifiability, sensitivity and the eclipse phase profilet = np.linspace(0, 20, num=1000)alpha = 4.93e-5D = 1k = 1E = 5epsilon = 0.001B = 8000C = 5t_inf = 1params = [alpha, D, k, E, epsilon, B, C, t_inf]def sim(variables, t, params):        # parameters    alpha, D, k, E, epsilon, B, C, t_inf = params            # Target cells    yT = variables[0]        # Eclipse stage 1 to k    y_eclipse = variables[1:1+k]        # Budding    yB = variables[2]        # Infectious Virions    v = variables[3]        # Non-nfectious Virions    w = variables[4]        # equations        #derivative vector    dy = [0]*(4+k)        # Target cells    dy[0] = -alpha * yT * v        # Eclipse sstage 1    dy[1] = alpha * yT * v - (D + k*E) * y_eclipse[0]        # Eclipse stages 1...k    for j in range(1, k):        dy[1+j] = k* E * y_eclipse[j-1] - (D + k * E) * y_eclipse[j]         # Budding cells    dy[1+k] = k * E * y_eclipse[-1] -D * yB        # Infected virus    dy[2+k] = epsilon * B * yB - alpha * yT * v - C * v        # Non-infectious virus    dy[3+k] = (1 - epsilon) * B * yB - C * w        return dy# Initial conditionsyT0 = 1.33e5y_eclipse0 = [0] * kyB0 = 1 / 30v0 = 0w0 = 0y0 = [yT0] + y_eclipse0 + [yB0, v0, w0]y = odeint(sim, y0, t, args=(params,))fig, axes = plt.subplots(5, 1, figsize=(7, 12), sharex=True)axes[0].plot(t, y[:,0]); axes[0].set_ylabel("Target cells")axes[1].plot(t, y[:,1]); axes[1].set_ylabel("Eclipse stage 1")axes[2].plot(t, y[:,2]); axes[2].set_ylabel("Budding cells")axes[3].plot(t, y[:,3]); axes[3].set_ylabel("Infectious virus")axes[4].plot(t, y[:,4]); axes[4].set_ylabel("Non-infectious virus")axes[4].set_xlabel("Time (days)")plt.tight_layout()plt.show()viral_load = y[:,3] + y[:,4]plt.figure(figsize=(7,4))plt.plot(t, np.log10(viral_load + 1))plt.ylabel("log10 viral load")plt.xlabel("Time (days)")plt.show()